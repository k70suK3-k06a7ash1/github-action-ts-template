# ADR-007: プロジェクト構成管理の選択

## ステータス

Accepted

## コンテキスト

プロジェクトの設定ファイル（package.json, tsconfig.json, .eslintrc等）をどのように管理するか決定する必要がある。

手動で管理する方法と、ツールを使って自動生成・管理する方法がある。

## 検討した選択肢

### 手動構成

各設定ファイルを直接作成・編集する。

| 観点 | 評価 |
|------|------|
| 透明性 | ◎ 全ファイルが見える |
| 柔軟性 | ◎ 自由にカスタマイズ |
| 学習コスト | ◎ 標準的な知識のみ |
| 依存 | ◎ なし |
| 一貫性 | △ 人依存 |
| 自動更新 | × 手動 |

### projen

```typescript
// .projenrc.ts
import { typescript } from 'projen'

new typescript.TypeScriptProject({
  name: 'my-action',
  deps: ['@actions/core'],
})
```

| 観点 | 評価 |
|------|------|
| 透明性 | △ 生成ファイルは編集不可 |
| 柔軟性 | ○ projen経由でカスタマイズ |
| 学習コスト | △ projen独自概念 |
| 依存 | △ projen必須 |
| 一貫性 | ◎ 自動で強制 |
| 自動更新 | ◎ npx projen |

### Nx

```json
// nx.json
{
  "targetDefaults": {
    "build": { "dependsOn": ["^build"] }
  }
}
```

| 観点 | 評価 |
|------|------|
| 透明性 | ○ |
| 柔軟性 | ◎ |
| 学習コスト | △ |
| 依存 | △ nx必須 |
| 一貫性 | ◎ |
| 自動更新 | ○ |

### copier

```yaml
# copier.yml
_templates_suffix: .jinja
project_name:
  type: str
```

| 観点 | 評価 |
|------|------|
| 透明性 | ◎ |
| 柔軟性 | ◎ |
| 学習コスト | ○ |
| 依存 | ○ Python |
| 一貫性 | ○ |
| 自動更新 | ◎ copier update |

## 決定

**手動構成** を採用する。

### 理由

1. **透明性**: 全ファイルが直接編集可能
2. **依存なし**: projen等の追加ツール不要
3. **学習コスト**: 標準的なNode.js/TypeScript知識で十分
4. **テンプレートとして適切**: 利用者が自由にカスタマイズ可能
5. **シンプル**: 単一リポジトリの小規模プロジェクト向け

### projenを選ぶべきケース

- 複数のGitHub Actionsを管理
- 設定の一貫性を自動で強制したい
- AWS CDKと併用している
- 依存関係の自動更新を行いたい

### Nxを選ぶべきケース

- モノレポ構成
- 複数パッケージ間の依存管理
- ビルドキャッシュが重要

### copierを選ぶべきケース

- 社内テンプレートの配布
- テンプレートの継続的な更新配信

## 結果

- 全設定ファイルを手動で管理
- 変更は直接ファイルを編集
- テンプレート利用者が自由にカスタマイズ可能
- 将来的にprojenへの移行も可能（別途ガイド提供）
